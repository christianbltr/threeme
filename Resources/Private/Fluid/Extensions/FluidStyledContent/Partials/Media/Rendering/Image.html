<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers" data-namespace-typo3-fluid="true">
<f:alias map="{
        cropMediaWidth: '{f:if(condition:\'{data.imagewidth} == {data.imageheight}\', then:\'{data.imagewidth}c\', else:\'{dimensions.width}\')}',
        cropMediaHeight: '{f:if(condition:\'{data.imagewidth} == {data.imageheight}\', then:\'{data.imageheight}c\', else:\'{dimensions.height}\')}'
    }"
>
    <f:if condition="{file.properties.crop}">
        <f:then>
            <picture>
                <source
                    media="(min-width: 768px)"
                    srcset="{f:uri.image(image:file, cropVariant:'desktop')}
                ">
                <source
                    media="(min-width: 480px)"
                    srcset="{f:uri.image(image:file, cropVariant:'tablet')}
                ">
                <source
                    srcset="{f:uri.image(image:file, cropVariant:'mobile')}
                ">
                <f:media
                    file="{file}"
                    width="{dimensions.width}"
                    height="{dimensions.height}"
                    alt="{file.alternative}"
                    title="{file.title}"
                    class="image-embed-item img-responsive{f:if(condition:'{data.layout}', then:' threeme-image-layout-{data.layout}')}"
                />
            </picture>
        </f:then>
        <f:else>
            <f:media
                file="{file}"
                width="{f:if(condition:'{data.imagewidth} > 0', then:'{cropMediaWidth}', else:'{dimensions.width}')}"
                height="{f:if(condition:'{data.imageheight} > 0', then:'{cropMediaHeight}', else:'{dimensions.height}')}"
                alt="{file.alternative}"
                title="{file.title}"
                class="image-embed-item img-responsive{f:if(condition:'{data.layout}', then:' threeme-image-layout-{data.layout}')}"
            />
        </f:else>
    </f:if>

    <f:comment>
        Watermarked images:
        Alternative implementation for watermarked image rendering.
        Note: EXT 'filemetadata' has to be activated if you want to use additional media fields.

        <f:cObject
            typoscriptObjectPath="lib.threemeWatermarkedImage"
            currentValueKey="uid"
            data="{
                uid: file.uid,
                width: '{f:if(condition: \'{data.imagewidth} > 0\', then: \'{cropMediaWidth}\', else: \'{dimensions.width}\')}',
                height: '{f:if(condition: \'{data.imageheight} > 0\', then: \'{cropMediaHeight}\', else: \'{dimensions.height}\')}',
                alt: file.alternative,
                title: file.title,
                params: 'class=\"image-embed-item img-responsive{f:if(condition:\'{data.layout}\', then:\' threeme-image-layout-{data.layout}\')}\"',
                watermark: column.media.properties.copyright
            }"
        />
    </f:comment>
</f:alias>
</html>
